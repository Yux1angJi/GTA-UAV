import numpy as np
import matplotlib.pyplot as plt
from scipy.interpolate import make_interp_spline


def plot_line_cross():
    # # D2S
    # # Semi-positive + Positive
    ## Cross-Area
    ### Triplet
    y_cross_triplet = [0., 0.7061446977205154, 2.911298315163528, 6.553518334985134, 9.452428146679882, 12.89643211100099, 16.253716551040633, 19.251734390485627, 22.670961347869177, 25.58225966303271, 28.902378592666008, 31.50396432111001, 33.88255698711596, 35.76560951437067, 37.35133795837463, 38.71407333994053, 39.79187314172448, 40.83250743310208, 41.83597621407334, 43.173934588701684, 44.214568880079284, 45.06937561942517, 46.04806739345887, 46.66749256689792, 47.5222993062438, 48.40188305252725, 49.05847373637265, 49.87611496531219, 50.594648166501486, 51.053022794846385, 51.64767096134787, 52.2794846382557, 52.83696729435084, 53.33250743310208, 53.865213082259665, 54.3607532210109, 54.75718533201189, 55.36422200198216, 55.89692765113974, 56.404856293359764, 56.76412289395441, 57.358771060455894, 57.74281466798811, 58.21357779980178, 58.684340931615466, 59.241823587710606, 59.74975222993062, 60.183349851337965, 60.72844400396432, 61.16204162537166, 61.48414271555996]
    ### InfoNCE
    y_cross_infonce = [0., 1.1769078295341924, 4.744796828543112, 10.183349851337958, 14.073339940535185, 19.003964321110008, 23.58771060455897, 27.291873141724484, 32.40832507433102, 36.36025768087215, 40.77056491575818, 44.15262636273538, 47.03914767096135, 49.554013875123886, 51.79633300297324, 53.45639246778989, 55.00495540138751, 56.1818632309217, 57.420713577799795, 58.597621407334, 59.58870168483648, 60.50545094152626, 61.42220019821606, 62.35133795837463, 63.39197224975223, 64.35827552031714, 65.25024777006938, 65.96878097125867, 66.72447968285431, 67.25718533201189, 67.78989098116948, 68.54558969276512, 69.00396432111002, 69.43756194251735, 69.75966303270566, 70.09415262636274, 70.45341922695738, 70.8994053518335, 71.20911793855302, 71.40733399405352, 71.65510406342915, 72.03914767096134, 72.37363726461842, 72.80723488602577, 73.20366699702676, 73.41427155599604, 73.82309217046581, 74.0832507433102, 74.38057482656095, 74.83894945490584, 75.11149653121902]
    ### InfoNCE w/. MES
    y_cross_infonce_wmes = [0., 1.3751238850346879, 5.636769078295342, 12.227452923686819, 17.517343904856293, 23.055004955401387, 28.456392467789893, 32.879088206144694, 38.08225966303271, 43.173934588701684, 48.030227948463825, 52.22993062438057, 55.50049554013875, 58.08969276511397, 60.406342913776015, 62.15312190287413, 63.40436075322101, 64.61843409316155, 65.74578790882062, 66.97224975222993, 67.81466798810703, 68.53320118929634, 69.41278493557978, 70.2552031714569, 71.14717542120911, 71.91526263627354, 72.52229930624381, 73.16650148662042, 73.81070366699703, 74.20713577799802, 74.51684836471755, 75.0, 75.4583746283449, 75.89197224975223, 76.22646184340933, 76.56095143706641, 76.9573835480674, 77.32903865213082, 77.61397423191279, 77.89890981169475, 78.15906838453914, 78.35728444003965, 78.5802775024777, 78.88999008919723, 79.15014866204163, 79.33597621407334, 79.52180376610507, 79.72001982160555, 79.91823587710604, 80.2775024777007, 80.4013875123885]
    ### weighted-InfoNCE w/. MES
    y_cross_winfonce_wmes = [0., 1.6105054509415264, 6.404856293359762, 13.181367690782952, 18.50842418235877, 24.690287413280476, 30.896927651139745, 35.678889990089196, 41.303270564915756, 46.56838453914767, 51.511397423191276, 55.68632309217046, 59.46481665014866, 62.40089197224975, 64.97770069375619, 67.13330029732408, 68.50842418235878, 69.64816650148661, 70.63924677898909, 71.91526263627354, 72.81962338949455, 73.42666005946482, 74.43012884043607, 75.12388503468782, 76.02824578790882, 76.90782953419227, 77.75024777006938, 78.36967294350843, 79.1625371655104, 79.78196233894946, 80.4633300297324, 81.02081268582755, 81.55351833498513, 81.88800792864221, 82.3587710604559, 82.79236868186322, 83.13924677898909, 83.3994053518335, 83.69672943508424, 83.87016848364718, 84.06838453914767, 84.21704658077304, 84.45242814667988, 84.68780971258671, 84.84886025768087, 84.94796828543112, 85.10901883052527, 85.31962338949455, 85.43111992071358, 85.65411298315163, 85.77799801783944]

    # S2D
    # Semi-positive + Positive
    ## Cross-Area
    ### Triplet
    # y_cross_triplet = [0., 0.5524861878453038, 4.23572744014733, 9.760589318600369, 18.96869244935543, 25.78268876611418, 34.06998158379374, 39.963167587476974, 44.935543278084715, 48.25046040515654, 52.117863720073665, 53.77532228360957, 55.06445672191529, 57.6427255985267, 60.40515653775322, 62.61510128913444, 64.27255985267035, 65.19337016574586, 66.66666666666666, 67.40331491712708, 67.58747697974218, 68.13996316758748, 68.87661141804789, 69.42909760589319, 69.9815837937385, 70.71823204419888, 71.27071823204419, 72.55985267034991, 73.11233885819522, 73.66482504604052, 74.21731123388582, 74.40147329650092, 74.76979742173113, 74.76979742173113, 74.95395948434623, 75.50644567219152, 75.87476979742172, 76.24309392265194, 76.24309392265194, 76.61141804788214, 76.97974217311234, 77.16390423572744, 77.90055248618785, 78.26887661141805, 78.26887661141805, 78.26887661141805, 78.63720073664825, 78.63720073664825, 78.82136279926335, 79.00552486187846, 79.00552486187846]
    # ### InfoNCE
    # y_cross_infonce = [0., 0.9208103130755065, 5.156537753222836, 13.627992633517497, 25.41436464088398, 34.43830570902394, 45.30386740331492, 51.01289134438306, 57.0902394106814, 61.141804788213626, 64.82504604051566, 67.58747697974218, 69.61325966850829, 72.37569060773481, 74.21731123388582, 76.97974217311234, 78.26887661141805, 79.74217311233886, 80.66298342541437, 81.95211786372008, 82.13627992633518, 83.05709023941068, 83.97790055248619, 84.34622467771639, 84.71454880294658, 84.8987108655617, 85.6353591160221, 86.1878453038674, 86.55616942909761, 87.10865561694291, 87.47697974217311, 87.66114180478822, 87.66114180478822, 88.02946593001842, 88.02946593001842, 88.02946593001842, 88.39779005524862, 88.39779005524862, 88.39779005524862, 88.39779005524862, 88.58195211786372, 88.76611418047882, 89.13443830570903, 89.68692449355433, 89.68692449355433, 89.68692449355433, 89.87108655616943, 89.87108655616943, 89.87108655616943, 90.05524861878453, 90.60773480662984]
    # ### InfoNCE w/. MES
    # y_cross_infonce_wmes = [0., 1.841620626151013, 6.998158379373849, 16.206261510128915, 27.255985267034994, 37.75322283609576, 48.43462246777164, 54.32780847145487, 57.826887661141804, 62.246777163904234, 65.74585635359117, 69.42909760589319, 70.90239410681399, 74.58563535911603, 77.71639042357275, 80.47882136279927, 82.68876611418048, 83.79373848987109, 84.5303867403315, 85.0828729281768, 85.451197053407, 85.6353591160221, 86.0036832412523, 87.47697974217311, 87.84530386740332, 88.58195211786372, 88.76611418047882, 88.95027624309392, 89.13443830570903, 89.13443830570903, 89.13443830570903, 89.13443830570903, 89.13443830570903, 89.31860036832413, 89.31860036832413, 89.68692449355433, 89.68692449355433, 89.87108655616943, 90.05524861878453, 90.23941068139963, 90.23941068139963, 90.42357274401473, 90.60773480662984, 90.79189686924494, 91.16022099447514, 91.16022099447514, 91.52854511970534, 91.52854511970534, 91.52854511970534, 91.52854511970534, 91.71270718232044]
    # ### weighted-InfoNCE w/. MES
    # y_cross_winfonce_wmes = [0., 2.0257826887661143, 9.023941068139964, 19.88950276243094, 33.88581952117864, 47.51381215469613, 61.51012891344383, 67.77163904235728, 71.08655616942909, 73.84898710865562, 77.71639042357275, 79.37384898710866, 80.84714548802947, 83.79373848987109, 85.451197053407, 87.66114180478822, 88.95027624309392, 89.68692449355433, 90.42357274401473, 90.42357274401473, 90.42357274401473, 90.42357274401473, 90.79189686924494, 90.97605893186004, 91.16022099447514, 91.16022099447514, 91.52854511970534, 91.52854511970534, 91.52854511970534, 91.52854511970534, 91.89686924493554, 92.08103130755065, 92.26519337016575, 92.26519337016575, 92.44935543278085, 92.44935543278085, 92.44935543278085, 92.44935543278085, 92.63351749539595, 92.63351749539595, 92.81767955801105, 92.81767955801105, 92.81767955801105, 93.18600368324125, 93.18600368324125, 93.18600368324125, 93.37016574585635, 93.37016574585635, 93.37016574585635, 93.55432780847146, 93.55432780847146]

    dis_threshold_cross_list = [10 * (i) for i in range(51)]
    dis_threshold_same_list = [10 * (i) for i in range(21)]

    plt.figure(figsize=(10, 6), dpi=300)

    y = np.array(y_cross_triplet)
    x = np.array(dis_threshold_cross_list)
    x_new = np.linspace(x.min(), x.max(), 500)
    spl = make_interp_spline(x, y, k=3)  
    y_smooth = spl(x_new)
    plt.plot(x_new, y_smooth, label='Triplet', color='green')

    y = np.array(y_cross_infonce)
    x = np.array(dis_threshold_cross_list)
    x_new = np.linspace(x.min(), x.max(), 500)
    spl = make_interp_spline(x, y, k=3)  
    y_smooth = spl(x_new)
    plt.plot(x_new, y_smooth, label='InfoNCE', color='orange')

    y = np.array(y_cross_infonce_wmes)
    x = np.array(dis_threshold_cross_list)
    x_new = np.linspace(x.min(), x.max(), 500)
    spl = make_interp_spline(x, y, k=3)  
    y_smooth = spl(x_new)
    plt.plot(x_new, y_smooth, label='InfoNCE w/. MES', color='purple')

    y = np.array(y_cross_winfonce_wmes)
    x = np.array(dis_threshold_cross_list)
    x_new = np.linspace(x.min(), x.max(), 500)
    spl = make_interp_spline(x, y, k=3)  
    y_smooth = spl(x_new)
    plt.plot(x_new, y_smooth, label='Weighted-InfoNCE w/. MES', color='red')

    plt.xlabel('Threshold (m)', fontsize=14)
    plt.ylabel('Accuracy (%)', fontsize=14)
    plt.legend(loc='upper left')
    plt.grid(True)
    plt.grid(color='gray', linestyle='--', linewidth=0.5)
    plt.xlim(0, 500)  # Set x-axis to start from 0
    plt.ylim(0, None)  # Set y-axis to start from 0

    # 调整边框
    # plt.gca().spines['top'].set_visible(False)
    # plt.gca().spines['right'].set_visible(False)

    # 显示图表
    plt.tight_layout()
    plt.savefig('/home/xmuairmud/jyx/GTA-UAV-private/Game4Loc/images/plot_acc_threshold_cross_area_d2s.png', bbox_inches='tight')
    # print(y.tolist())


def plot_line_same():
    # # D2S
    # # Semi-positive + Positive
    # ## Same-Area
    ### Triplet
    y_same_triplet = [0., 0.1309328968903437, 1.0474631751227497, 2.3567921440261865, 4.615384615384616, 8.28150572831424, 11.914893617021278, 15.74468085106383, 19.574468085106382, 22.684124386252048, 25.957446808510635, 29.819967266775777, 33.387888707037646, 36.661211129296234, 39.83633387888707, 43.175122749590834, 47.00490998363339, 49.91816693944354, 53.28968903436988, 56.46481178396072, 59.63993453355155, 62.160392798690665, 64.81178396072012, 66.90671031096564, 69.62356792144027, 71.48936170212767, 73.64975450081833, 75.64648117839607, 77.38134206219313, 78.98527004909982, 80.2291325695581, 81.6366612111293, 82.88052373158756, 84.32078559738135, 84.71358428805237, 85.49918166939443, 86.21931260229132, 86.61211129296235, 87.36497545008183, 87.79050736497544, 88.1178396072013, 88.34697217675941, 88.8707037643208, 89.39443535188217, 89.65630114566284, 90.14729950900163, 90.47463175122749, 90.90016366612112, 91.12929623567922, 91.3911620294599, 91.68576104746317]
    ### InfoNCE
    y_same_infonce = [0., 0.2945990180032733, 1.2438625204582652, 3.011456628477905, 5.237315875613748, 9.132569558101473, 12.896890343698855, 17.18494271685761, 21.04746317512275, 23.862520458265138, 26.939443535188218, 30.867430441898524, 34.50081833060557, 37.97054009819967, 40.687397708674304, 44.288052373158756, 48.28150572831424, 51.35842880523731, 54.53355155482815, 57.38134206219313, 60.196399345335514, 62.782324058919805, 65.00818330605564, 67.62684124386253, 69.85270049099836, 71.98036006546646, 74.33715220949263, 76.2684124386252, 78.23240589198036, 80.16366612111293, 81.47299509001637, 83.0114566284779, 83.99345335515548, 85.3355155482815, 86.18657937806874, 87.13584288052373, 88.18330605564648, 88.54337152209493, 89.23076923076924, 89.59083469721769, 89.88543371522096, 90.31096563011457, 90.60556464811785, 91.06382978723404, 91.42389525368249, 91.75122749590835, 92.04582651391162, 92.37315875613747, 92.66775777414075, 92.7986906710311, 93.06055646481178]
    ### InfoNCE w/. MES
    y_same_infonce_wmes =  [0., 0.32733224222585927, 1.309328968903437, 3.044189852700491, 5.466448445171849, 9.525368248772505, 13.747954173486088, 18.101472995090017, 21.76759410801964, 24.90998363338789, 28.18330605564648, 31.98036006546645, 35.74468085106383, 39.247135842880525, 41.96399345335515, 45.40098199672668, 48.739770867430444, 51.685761047463174, 54.6644844517185, 57.446808510638306, 60.261865793780686, 62.88052373158756, 65.30278232405891, 67.82324058919804, 69.95090016366612, 72.11129296235679, 74.79541734860884, 76.759410801964, 78.91980360065467, 80.85106382978722, 82.7823240589198, 84.09165302782324, 84.81178396072013, 85.92471358428804, 86.54664484451719, 87.16857610474632, 88.08510638297872, 88.64157119476268, 89.13256955810147, 89.59083469721769, 90.04909983633388, 90.60556464811785, 91.19476268412438, 91.55482815057283, 91.8821603927987, 92.20949263502455, 92.47135842880525, 92.83142389525368, 93.15875613747954, 93.45335515548283, 93.58428805237315]
    ### weighted-InfoNCE w/. MES
    y_same_winfonce_wmes = [0., 0.36006546644844517, 1.3747954173486088, 3.240589198036006, 5.761047463175123, 9.88543371522095, 13.780687397708673, 18.265139116202946, 22.684124386252048, 25.466448445171853, 28.412438625204583, 32.04582651391162, 35.94108019639934, 39.57446808510638, 42.58592471358429, 45.89198036006547, 49.754500818330605, 52.73322422258593, 56.33387888707038, 59.27986906710311, 62.324058919803605, 65.04091653027824, 67.9214402618651, 70.4746317512275, 72.92962356792144, 74.63175122749591, 76.69394435351882, 78.49427168576105, 79.86906710310966, 81.60392798690671, 82.5531914893617, 84.25531914893617, 85.40098199672667, 86.7430441898527, 87.49590834697217, 88.54337152209493, 89.62356792144026, 90.31096563011457, 90.83469721767594, 91.55482815057283, 92.1112929623568, 92.56955810147299, 92.92962356792144, 93.22422258592471, 93.55155482815057, 93.84615384615384, 94.07528641571194, 94.43535188216039, 94.76268412438625, 95.05728314238952, 95.15548281505728]

    # S2D
    # Semi-positive + Positive
    ## Same-Area
    ### Triplet
    # y_same_triplet = [0., 1.7948717948717947, 8.461538461538462, 21.153846153846153, 38.205128205128204, 53.58974358974359, 70.64102564102565, 80.51282051282051, 86.7948717948718, 91.15384615384615, 92.56410256410257, 94.74358974358974, 96.15384615384616, 96.92307692307692, 97.3076923076923, 97.82051282051282, 98.46153846153847, 99.23076923076923, 99.35897435897436, 99.48717948717949, 99.74358974358975, 99.74358974358975, 99.74358974358975, 99.74358974358975, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0][:21]
    # ### InfoNCE
    # y_same_infonce = [0., 1.6666666666666667, 8.076923076923077, 20.76923076923077, 35.76923076923077, 52.56410256410257, 70.25641025641025, 80.12820512820514, 86.02564102564104, 90.76923076923077, 93.2051282051282, 95.25641025641025, 96.02564102564102, 96.66666666666667, 97.17948717948718, 97.6923076923077, 98.2051282051282, 99.1025641025641, 99.23076923076923, 99.23076923076923, 99.48717948717949, 99.61538461538461, 99.61538461538461, 99.61538461538461, 99.61538461538461, 99.61538461538461, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488, 99.87179487179488][0:21]
    # ### InfoNCE w/. MES
    # y_same_infonce_wmes =  [0., 1.6666666666666667, 7.948717948717948, 21.28205128205128, 36.794871794871796, 54.61538461538461, 71.66666666666667, 79.87179487179488, 85.76923076923076, 89.23076923076924, 91.66666666666666, 94.35897435897435, 94.74358974358974, 95.38461538461539, 96.28205128205128, 96.92307692307692, 97.94871794871794, 98.97435897435898, 99.1025641025641, 99.23076923076923, 99.35897435897436, 99.35897435897436, 99.61538461538461, 99.74358974358975, 99.87179487179488, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0][:21]
    # ### weighted-InfoNCE w/. MES
    # y_same_winfonce_wmes = [0., 1.6666666666666667, 8.461538461538462, 22.435897435897438, 38.71794871794872, 55.64102564102564, 73.33333333333333, 82.17948717948718, 88.97435897435896, 92.82051282051282, 94.48717948717949, 95.8974358974359, 96.66666666666667, 97.17948717948718, 97.82051282051282, 98.2051282051282, 98.84615384615385, 99.61538461538461, 99.74358974358975, 99.74358974358975, 99.87179487179488, 99.87179487179488, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0][:21]

    dis_threshold_cross_list = [10 * (i) for i in range(51)]
    dis_threshold_same_list = [4 * (i) for i in range(51)]

    plt.figure(figsize=(10, 6), dpi=300)

    y = np.array(y_same_triplet)
    x = np.array(dis_threshold_same_list)
    x_new = np.linspace(x.min(), x.max(), 500)
    spl = make_interp_spline(x, y, k=3)  
    y_smooth = spl(x_new)
    plt.plot(x_new, y_smooth, label='Triplet', color='green')

    y = np.array(y_same_infonce)
    x = np.array(dis_threshold_same_list)
    x_new = np.linspace(x.min(), x.max(), 500)
    spl = make_interp_spline(x, y, k=3)  
    y_smooth = spl(x_new)
    plt.plot(x_new, y_smooth, label='InfoNCE', color='orange')

    y = np.array(y_same_infonce_wmes)
    x = np.array(dis_threshold_same_list)
    x_new = np.linspace(x.min(), x.max(), 500)
    spl = make_interp_spline(x, y, k=3)  
    y_smooth = spl(x_new)
    plt.plot(x_new, y_smooth, label='InfoNCE w/. MES', color='purple')

    y = np.array(y_same_winfonce_wmes)
    x = np.array(dis_threshold_same_list)
    x_new = np.linspace(x.min(), x.max(), 500)
    spl = make_interp_spline(x, y, k=3)  
    y_smooth = spl(x_new)
    plt.plot(x_new, y_smooth, label='Weighted-InfoNCE w/. MES', color='red')

    plt.xlabel('Threshold (m)', fontsize=14)
    plt.ylabel('Accuracy (%)', fontsize=14)
    plt.legend(loc='upper left')
    plt.grid(True)
    plt.grid(color='gray', linestyle='--', linewidth=0.5)
    plt.xlim(0, 200)  # Set x-axis to start from 0
    plt.ylim(0, None)  # Set y-axis to start from 0

    # 调整边框
    # plt.gca().spines['top'].set_visible(False)
    # plt.gca().spines['right'].set_visible(False)

    # 显示图表
    plt.tight_layout()
    plt.savefig('/home/xmuairmud/jyx/GTA-UAV-private/Game4Loc/images/plot_acc_threshold_same_area_d2s.png', bbox_inches='tight')
    # print(y.tolist())


if __name__ == '__main__':
    plot_line_same()
    # plot_line_cross()